#!/bin/bash

get_weather() {
    local weather_data temperature condition_code icon condition
    
    # ïºï» ïº‘ ïºï»³ïºï»§ïºïº— ïºï» ï»„ï»˜ïº³ (ïº©ïº®ïºŸïº“ ïºï» ïº£ïº­ïºïº­ïº“ ï»­ïº®ï»£ïº¯ ïºï» ï»„ï»˜ïº³)
    weather_data=$(curl -s "https://api.open-meteo.com/v1/forecast?latitude=30.7514&longitude=31.4578&current=temperature_2m,weathercode")
    temperature=$(echo "$weather_data" | jq '.current.temperature_2m')
    condition_code=$(echo "$weather_data" | jq '.current.weathercode')
    
    # ïº–ïº£ï»®ï»´ï»Ÿ ïº®ï»£ïº¯ ïºï» ï»„ï»˜ïº³ ïºˆï»Ÿï»¯ ï»®ïº¼ï»“
    case "$condition_code" in
        0) condition="Clear" ;;  # â˜€ï¸ Ø´Ù…Ø³ Ù…Ø´Ø±Ù‚Ø©
        1|2|3) condition="Cloudy" ;;  # â›… ØºØ§Ø¦Ù… Ø¬Ø²Ø¦ÙŠÙ‹Ø§ Ø¥Ù„Ù‰ ÙƒÙ„ÙŠÙ‹Ø§
        45|48) condition="Fog" ;;  # ğŸŒ«ï¸ Ø¶Ø¨Ø§Ø¨
        51|53|55|56|57) condition="Showers" ;;  # ğŸŒ¦ï¸ Ø²Ø®Ø§Øª Ù…Ø·Ø± Ø®ÙÙŠÙØ© Ø¥Ù„Ù‰ Ù…ØªÙˆØ³Ø·Ø©
        61|63|65|66|67) condition="Rain" ;;  # ğŸŒ§ï¸ Ø£Ù…Ø·Ø§Ø±
        71|73|75|77) condition="Snow" ;;  # â„ï¸ Ø«Ù„ÙˆØ¬
        80|81|82) condition="Showers" ;;  # ğŸŒ¦ï¸ Ø²Ø®Ø§Øª Ù…Ø·Ø± ØºØ²ÙŠØ±Ø©
        85|86) condition="Snow" ;;  # â„ï¸ Ø²Ø®Ø§Øª Ø«Ù„Ø¬ÙŠØ©
        95|96|99) condition="Thunderstorm" ;;  # â›ˆï¸ Ø¹ÙˆØ§ØµÙ Ø±Ø¹Ø¯ÙŠØ©
        *) condition="" ;;  # â“ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ
    esac
    
    local hour=$(date '+%H')  # ïºï» ïº¤ïº»ï»®ï»Ÿ ï»Šï»Ÿï»¯ ïºï» ïº³ïºï»‹ïº“ ïºï» ïº£ïºï» ï»³ïº“ (00-23)
    
    # ïºïº¨ïº˜ï»³ïºïº­ ïºï»¸ï»´ï»—ï»®ï»§ïº“ ïº¢ïº´ïº‘ ïº¡ïºï»Ÿïº“ ïºï» ï»„ï»˜ïº³ ï»­ïºï»Ÿï»®ï»˜ïº—
    if [ "$hour" -ge 18 ] || [ "$hour" -lt 6 ]; then
        case "$condition" in
            "Clear") icon="ğŸŒ™" ;;  # Ø³Ù…Ø§Ø¡ ØµØ§ÙÙŠØ© Ù„ÙŠÙ„Ù‹Ø§
            "Cloudy") icon="â˜" ;;
            "Fog") icon="ğŸŒ«ï¸" ;;
            "Showers" | "Rain") icon="ğŸŒ§ï¸" ;;
            "Snow") icon="â„ï¸" ;;
            "Thunderstorm") icon="â›ˆï¸" ;;
            *) icon="ğŸŒ" ;;
        esac
    else
        case "$condition" in
            "Clear") icon="â˜€ï¸" ;;
            "Cloudy") icon="â›…" ;;
            "Fog") icon="ğŸŒ«ï¸" ;;
            "Showers" | "Rain") icon="ğŸŒ¦ï¸" ;;
            "Snow") icon="â„ï¸" ;;
            "Thunderstorm") icon="â›ˆï¸" ;;
            *) icon="ğŸŒ" ;;
        esac
    fi
    
    echo "${icon} ${condition} ${temperature}Â°C"
}

get_weather

